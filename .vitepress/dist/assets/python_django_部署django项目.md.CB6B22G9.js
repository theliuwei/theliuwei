import{_ as s,c as a,o as i,a4 as n}from"./chunks/framework.DF40YQsC.js";const E=JSON.parse('{"title":"部署 Django 项目","description":"","frontmatter":{},"headers":[],"relativePath":"python/django/部署django项目.md","filePath":"python/django/部署django项目.md"}'),p={name:"python/django/部署django项目.md"},e=n(`<h1 id="部署-django-项目" tabindex="-1">部署 Django 项目 <a class="header-anchor" href="#部署-django-项目" aria-label="Permalink to &quot;部署 Django 项目&quot;">​</a></h1><h2 id="windows-操纵系统下部署-django-项目" tabindex="-1">Windows 操纵系统下部署 django 项目 <a class="header-anchor" href="#windows-操纵系统下部署-django-项目" aria-label="Permalink to &quot;Windows 操纵系统下部署 django 项目&quot;">​</a></h2><p>默认操作系统已经安装了 python</p><h3 id="案例" tabindex="-1">案例 <a class="header-anchor" href="#案例" aria-label="Permalink to &quot;案例&quot;">​</a></h3><p>以<code>D盘</code> 根目录为主，创建 code 文件夹（目录）和 env 文件夹（目录）。</p><h4 id="创建虚拟环境" tabindex="-1">创建虚拟环境 <a class="header-anchor" href="#创建虚拟环境" aria-label="Permalink to &quot;创建虚拟环境&quot;">​</a></h4><p>打开终端，输入如下命令 my_env 的名字随便更换。</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> venv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my_env</span></span></code></pre></div><h4 id="切换虚拟环境" tabindex="-1">切换虚拟环境 <a class="header-anchor" href="#切换虚拟环境" aria-label="Permalink to &quot;切换虚拟环境&quot;">​</a></h4><div class="language-css vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cd my_env</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cd Scripts</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">activate</span></span></code></pre></div><h4 id="安装项目所需环境" tabindex="-1">安装项目所需环境 <a class="header-anchor" href="#安装项目所需环境" aria-label="Permalink to &quot;安装项目所需环境&quot;">​</a></h4><p>默认已经把项目放到了 code 目录中了，使用刚才的终端切换目录切换到<code>D:\\code\\项目</code>。</p><div class="language-css vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cd D:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ode</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\项</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">目</span></span></code></pre></div><p>升级 pip</p><div class="language-css vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pip install --upgrade pip</span></span></code></pre></div><p>下载项目所需要第三方库，默认的项目所需的第三方库已经写入项目中的<code>requirements.txt</code></p><div class="language-css vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pip install -r requirements</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.txt</span></span></code></pre></div><p>下载<code>supervisor-win</code></p><div class="language-css vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pip install </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">supervisor-win</span></span></code></pre></div><p>配置 supervisord （使用如下命令就会在项目目录下创建 supervisord.conf 文件）</p><div class="language-css vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">echo_supervisord_conf</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.exe</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> supervisord</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.conf</span></span></code></pre></div><p>修改 supervisorsd.conf 文件内容</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>[program: theproject]</span></span>
<span class="line"><span>command=D:\\\\env\\\\项目虚拟环境\\\\Scripts\\\\waitress-serve.exe --listen=*:9909 项目.wsgi:application</span></span>
<span class="line"><span>directory=D:\\\\code\\\\项目</span></span>
<span class="line"><span>user=Administrator</span></span>
<span class="line"><span>autostart=true</span></span>
<span class="line"><span>autorestart=true</span></span>
<span class="line"><span>startsecs=10</span></span>
<span class="line"><span>redirect_stderr=true</span></span>
<span class="line"><span>stdout_logfile=D:\\\\code\\\\项目\\\\logs\\\\supervisor_out.log</span></span>
<span class="line"><span>stderror_logfile=D:\\\\code\\\\项目\\\\logs\\\\supervisor_err.log</span></span>
<span class="line"><span>stdout_logfile_maxbytes=1MB</span></span>
<span class="line"><span>stdout_logfile_backups=10</span></span></code></pre></div><p>字段解释</p><p>[program: theproject] 固定写法，the project 更换为项目的名称，英文。</p><p>command：需要执行的命令，建议使用绝对路径，windows 就使用两个<code>\\\\</code></p><p>directory: 工作目录</p><p>autostart: 自动启动， 默认开启</p><p>autorestart: 自动重启</p><p>redirect_stderr: 重定向标准错误日志输出到标准输出，也可以单独输出。</p><p>stdout_logfile:标准输出目录。<code>目录一定要存在，否则报错</code></p><p>stdout_logfile_maxbytes: 单文件最大空间，超过了另一个文件。</p><p>stdout_logfile_backups: 最多保持的日志文件数</p><h4 id="编辑-supervisorsd-conf-其他内容" tabindex="-1">编辑 supervisorsd.conf 其他内容 <a class="header-anchor" href="#编辑-supervisorsd-conf-其他内容" aria-label="Permalink to &quot;编辑 supervisorsd.conf 其他内容&quot;">​</a></h4><p>找到如下内容，将它前面的<code>;</code>删除</p><div class="language-css vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">inet_http_server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">port=127</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.0.0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:9001</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">username=user</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">password=123</span></span></code></pre></div><div class="language-css vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">supervisord</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">logfile=D:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">code</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">项目</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">logs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">supervisord.log;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">logfile_maxbytes=50MB;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">logfile_backups=10;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">loglevel=info;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pidfile=D:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">code</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">项目</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">logs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">supervisord.pid;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nodaemon=false;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">silent=false;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">minfds=1024;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">minprocs=200;</span></span></code></pre></div><div class="language-css vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">supervisorctl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">serverurl=http://127</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.0.0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:9001;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">username=user;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">password=123;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prompt=mysupervisor;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">history_file=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">.sc_history;</span></span></code></pre></div><p>编辑完，关闭文件。</p><h3 id="启动项目" tabindex="-1">启动项目 <a class="header-anchor" href="#启动项目" aria-label="Permalink to &quot;启动项目&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">supervisord</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">upervisord.conf</span></span></code></pre></div><p>ln laknsdlaskndlsadlnkdnasd</p>`,42),t=[e];function l(h,d,k,o,r,c){return i(),a("div",null,t)}const u=s(p,[["render",l]]);export{E as __pageData,u as default};
